{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://raw.githubusercontent.com/microsoft/MLOS/main/mlos_bench/mlos_bench/config/schemas/tunables/tunable-values-schema.json",
    "title": "mlos_bench Tunable values config",

    "$defs": {
        "tunable_values_set": {
            "type": "object",
            "patternProperties": {
                "^[^$]+$": {
                    "$comment": "Tunable values are either strings, numbers, booleans or nulls.",
                    "type": ["string", "number", "boolean", "null"]
                },
                "^[$].+$": {
                    "$comment": "Meta properties are prefixed with a $.",
                    "type": "string"
                }
            },
            "not": {
                "properties": {
                    "tunable_values": {}
                },
                "required": ["tunable_values"]
            },
            "unevaluatedProperties": true
        }
    },

    "oneOf": [
        {
            "allOf": [
                {
                    "type": "object",
                    "properties": {
                        "$schema": {
                            "$comment": "Optionally allow the schema to be specified in the top level of the config, but make sure it matches the expected schema.",
                            "type": "string",
                            "pattern": "/schemas/tunables/tunable-values-schema.json$"
                        }
                    }
                },
                {
                    "$ref": "#/$defs/tunable_values_set"
                }
            ],
            "$comment": "TODO: Add support for lists of tunable values as well."
        },
        {
            "$comment": "Allow an object that specifies the schema and the tunable values separately - useful for eventual support of lists of tunable values.",
            "type": "object",
            "properties": {
                "$schema": {
                    "type": "string",
                    "pattern": "/schemas/tunables/tunable-values-schema.json$"
                },
                "tunable_values": {
                    "oneOf": [
                        {
                            "$ref": "#/$defs/tunable_values_set"
                        }
                    ],
                    "$comment": "TODO: Add support for lists of tunable values as well."
                },
                "required": ["tunable_values"]
            },
            "unevaluatedProperties": false
        }
    ]
}
